<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediaMind AI | Enterprise Suite</title>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            min-height: 100vh;
            background-color: #0B1121;
            color: #e2e8f0;
            font-family: 'Outfit', sans-serif;
            overflow: hidden;
        }

        #root {
            height: 100vh;
        }

        /* Solid panels (no transparency) */
        .glass-panel {
            background: #0f172a;
            backdrop-filter: none;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 24px 0 rgba(0, 0, 0, 0.35);
        }

        /* Profile popover should stay opaque enough to hide content underneath */
        .profile-popover {
            background: rgba(15, 23, 42, 0.92) !important;
            backdrop-filter: blur(16px);
        }

        .sidebar-link {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
        }

        .sidebar-link:hover,
        .sidebar-link.active {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, transparent 100%);
            border-left-color: #3b82f6;
            color: #fff;
        }

        .sidebar-link.active i {
            color: #3b82f6;
            filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.5));
        }

        /* Custom Input */
        .input-dark {
            background: #151e32;
            border: 1px solid #2d3b55;
            color: white;
            transition: 0.3s;
        }

        .input-dark:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 10px rgba(59, 130, 246, 0.2);
            }

            50% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            }
        }

        .animate-glow {
            animation: pulse-glow 2s infinite;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease-out;
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }

            100% {
                background-position: 1000px 0;
            }
        }

        .shimmer-loading {
            background: linear-gradient(90deg, #1e293b 25%, #2d3b55 50%, #1e293b 75%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }

        /* Stat Cards */
        .stat-card {
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, transparent 100%);
            pointer-events: none;
        }

        /* Badge */
        .badge-success {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .badge-warning {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .badge-info {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* Gradient Text */
        .gradient-text {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Progress Bar */
        .progress-bar {
            background: #1e293b;
            border-radius: 10px;
            overflow: hidden;
            height: 6px;
        }

        .progress-bar::after {
            content: '';
            display: block;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            height: 100%;
            border-radius: 10px;
        }
    </style>
</head>

<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const API_BASE = "http://127.0.0.1:8000";

        // --- HELPER: API CALLER ---
        const callGeminiAPI = async (endpoint, payload, mockResponse) => {
            try {
                const res = await fetch(`${API_BASE}${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!res.ok) throw new Error("Backend failed");
                return await res.json();
            } catch (error) {
                console.warn("Backend offline, using mock.");
                await new Promise(r => setTimeout(r, 800));
                return mockResponse;
            }
        };

        const LoadingDots = () => (
            <div className="flex space-x-1 items-center justify-center p-4">
                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{ animationDelay: '0s' }}></div>
                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }}></div>
                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
            </div>
        );

        const Icon = ({ name, size = 18, className = '' }) => {
            const icons = {
                'check-circle': '‚úì',
                'trending-up': 'üìà',
                'alert-circle': '‚ö†Ô∏è',
                'zap': '‚ö°',
                'bar-chart': 'üìä',
                'globe': 'üåê',
                'shield-check': 'üõ°Ô∏è',
                'bell': 'üîî',
                'settings': '‚öôÔ∏è',
                'smile': 'üòä',
                'layout-grid': 'üìë',
                'languages': 'üåê',
                'shield-alert': 'üõ°Ô∏è',
                'bar-chart-2': 'üìä',
                'file-text': 'üìÑ',
                'arrow-right': '‚Üí',
                'activity': 'üìç',
                'check': '‚úì',
                'cpu': 'üíª',
                'trophy': 'üèÜ',
                'gamepad-2': 'üéÆ',
            };
            return <span className={className} style={{ fontSize: `${size}px` }}>{icons[name] || '‚Ä¢'}</span>;
        };

        // --- COMPONENTS ---

        // 1. DASHBOARD HOME
        const DashboardHome = () => (
            <div className="space-y-6 fade-in p-6">
                {/* Top Stats */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div className="glass-panel p-6 rounded-2xl stat-card border-l-4 border-blue-500">
                        <div className="flex justify-between items-start mb-4">
                            <h3 className="text-gray-400 text-xs font-bold uppercase tracking-wider">System Status</h3>
                            <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                        </div>
                        <div className="text-3xl font-bold text-white">Operational</div>
                        <div className="flex items-center gap-2 mt-3 text-green-400 text-xs"><Icon name="check-circle" size={14} /> All Systems Active</div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl stat-card border-l-4 border-purple-500">
                        <h3 className="text-gray-400 text-xs font-bold uppercase tracking-wider mb-4">Analyzed Posts</h3>
                        <div className="text-3xl font-bold text-white">12,847</div>
                        <div className="text-purple-400 text-xs mt-3 flex items-center gap-1"><Icon name="trending-up" size={14} /> +24% this week</div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl stat-card border-l-4 border-pink-500">
                        <h3 className="text-gray-400 text-xs font-bold uppercase tracking-wider mb-4">Content Curated</h3>
                        <div className="text-3xl font-bold text-white">3.2k</div>
                        <div className="text-pink-400 text-xs mt-3">Personalized feeds generated</div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl stat-card border-l-4 border-red-500">
                        <h3 className="text-gray-400 text-xs font-bold uppercase tracking-wider mb-4">Threats Blocked</h3>
                        <div className="text-3xl font-bold text-white">347</div>
                        <div className="text-red-400 text-xs mt-3 flex items-center gap-1"><Icon name="alert-circle" size={14} /> Misinformation flagged</div>
                    </div>
                </div>

                {/* Activity & Performance */}
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div className="lg:col-span-2 glass-panel p-6 rounded-2xl">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="font-bold text-white">API Performance (24h)</h3>
                            <span className="badge-success text-xs px-3 py-1 rounded-full">Optimal</span>
                        </div>
                        <div className="space-y-4">
                            {[
                                { name: 'Sentiment Analysis', usage: 85, color: 'from-blue-500 to-blue-600' },
                                { name: 'Recommendations', usage: 92, color: 'from-purple-500 to-purple-600' },
                                { name: 'Translation', usage: 68, color: 'from-yellow-500 to-yellow-600' },
                                { name: 'Safety Verification', usage: 78, color: 'from-red-500 to-red-600' }
                            ].map((item, i) => (
                                <div key={i}>
                                    <div className="flex justify-between mb-2">
                                        <span className="text-sm text-gray-400">{item.name}</span>
                                        <span className="text-sm font-bold text-white">{item.usage}%</span>
                                    </div>
                                    <div className="progress-bar" style={{ ['--progress']: `${item.usage}%` }}>
                                        <div className={`bg-gradient-to-r ${item.color} h-full`} style={{ width: `${item.usage}%` }}></div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="glass-panel p-6 rounded-2xl">
                        <h3 className="font-bold text-white mb-6">Recent Activity</h3>
                        <div className="space-y-4 text-sm">
                            {[
                                { icon: 'activity', text: 'Sentiment spike detected', time: '2m ago', color: 'text-blue-400' },
                                { icon: 'alert-circle', text: 'Fake news article blocked', time: '15m ago', color: 'text-red-400' },
                                { icon: 'check-circle', text: 'Translation completed', time: '32m ago', color: 'text-green-400' },
                                { icon: 'zap', text: 'Insights report generated', time: '1h ago', color: 'text-yellow-400' }
                            ].map((item, i) => (
                                <div key={i} className="flex items-center gap-3 pb-3 border-b border-slate-700/50 last:border-0">
                                    <Icon name={item.icon} size={16} className={item.color} />
                                    <div className="flex-1">
                                        <div className="text-gray-300">{item.text}</div>
                                        <div className="text-xs text-gray-500">{item.time}</div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>

                {/* Quick Access Modules */}
                <h3 className="text-lg font-bold text-white mt-2 mb-4">Feature Modules</h3>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    {[
                        { id: 'sentiment', title: 'Sentiment Analysis', desc: 'Analyze public emotion & tone', icon: 'smile', color: 'text-blue-400', href: 'f1_sentiment.html', badge: 'Popular' },
                        { id: 'recommend', title: 'Smart Feed', desc: 'AI-Curated news recommendations', icon: 'layout-grid', color: 'text-purple-400', href: 'f2_recommend.html', badge: 'New' },
                        { id: 'translate', title: 'Live Translator', desc: 'Real-time multi-language support', icon: 'languages', color: 'text-yellow-400', href: 'f3_translate.html', badge: 'Beta' },
                        { id: 'fakenews', title: 'Safety Shield', desc: 'Detect misinformation & hate speech', icon: 'shield-alert', color: 'text-red-400', href: 'f4_safety.html', badge: 'Essential' },
                        { id: 'insights', title: 'Trend Analytics', desc: 'Forecast viral topics', icon: 'bar-chart-2', color: 'text-pink-400', href: 'f5_insights.html', badge: 'Pro' },
                        { id: 'summary', title: 'Auto Summarizer', desc: 'Condense long documents', icon: 'file-text', color: 'text-green-400', href: 'f6_summary.html', badge: 'Useful' },
                    ].map(item => (
                        <a key={item.id} href={item.href} className="glass-panel p-6 rounded-xl hover:border-blue-500/50 transition-all duration-300 text-left group hover:shadow-lg hover:shadow-blue-900/20 no-underline relative overflow-hidden">
                            <div className="absolute top-2 right-2">
                                <span className={`text-[10px] font-bold px-2 py-1 rounded ${item.badge === 'New' ? 'badge-info' :
                                        item.badge === 'Popular' ? 'badge-success' :
                                            item.badge === 'Beta' ? 'badge-warning' :
                                                'badge-info'
                                    }`}>{item.badge}</span>
                            </div>
                            <div className={`mb-4 p-3 rounded-lg bg-slate-800/50 w-fit group-hover:scale-110 transition ${item.color}`}>
                                <Icon name={item.icon} size={24} />
                            </div>
                            <h4 className="font-bold text-lg text-white">{item.title}</h4>
                            <p className="text-sm text-gray-400 mt-1">{item.desc}</p>
                            <div className="flex items-center gap-2 mt-4 text-blue-400 text-xs font-semibold opacity-0 group-hover:opacity-100 transition">
                                Access <Icon name="arrow-right" size={12} />
                            </div>
                        </a>
                    ))}
                </div>
            </div>
        );

        // 2. SENTIMENT ANALYSIS
        const FeatureSentiment = () => {
            const [text, setText] = useState("");
            const [result, setResult] = useState(null);
            const [loading, setLoading] = useState(false);

            const analyzeSentimentLocal = (text) => {
                const textLower = text.toLowerCase();

                // Extended Positive keywords
                const positiveWords = [
                    'love', 'great', 'amazing', 'excellent', 'wonderful', 'awesome', 'fantastic',
                    'good', 'best', 'happy', 'perfect', 'beautiful', 'brilliant', 'superb',
                    'lovely', 'nice', 'great', 'awesome', 'fantastic', 'fabulous', 'marvelous',
                    'fun', 'enjoy', 'like', 'adore', 'appreciate', 'glad', 'pleased',
                    'satisfied', 'impressed', 'delighted', 'thrilled', 'excited', 'wonderful'
                ];

                // Extended Negative keywords
                const negativeWords = [
                    'hate', 'terrible', 'awful', 'bad', 'horrible', 'worst', 'disgusting',
                    'poor', 'sad', 'angry', 'disappointing', 'useless', 'stupid', 'waste',
                    'fail', 'failed', 'fails', 'problem', 'problems', 'issue', 'issues',
                    'broken', 'broke', 'sucks', 'sick', 'poor', 'pathetic', 'abysmal',
                    'dreadful', 'miserable', 'annoying', 'annoyed', 'frustrated', 'disappointed', 'regret'
                ];

                // Check for emojis
                const positiveEmojis = ['üòä', 'üòÑ', 'üòç', '‚ù§Ô∏è', 'üëç', 'üéâ', '‚ú®', 'üòÇ', 'ü•∞'];
                const negativeEmojis = ['üòû', 'üò§', 'üò†', 'üíî', 'üëé', 'üò°', 'ü§Æ', 'üò≠'];

                let positiveCount = positiveWords.filter(w => textLower.includes(w)).length;
                let negativeCount = negativeWords.filter(w => textLower.includes(w)).length;

                positiveCount += positiveEmojis.filter(e => text.includes(e)).length * 2;
                negativeCount += negativeEmojis.filter(e => text.includes(e)).length * 2;

                let sentiment, confidence, tone;
                if (positiveCount > negativeCount && positiveCount > 0) {
                    sentiment = "Positive";
                    confidence = Math.min(95, 65 + positiveCount * 8) + "%";
                    tone = "Enthusiastic";
                } else if (negativeCount > positiveCount && negativeCount > 0) {
                    sentiment = "Negative";
                    confidence = Math.min(95, 65 + negativeCount * 8) + "%";
                    tone = "Frustrated";
                } else if (positiveCount + negativeCount > 0) {
                    sentiment = positiveCount > negativeCount ? "Positive" : "Negative";
                    confidence = "55%";
                    tone = "Mixed";
                } else {
                    sentiment = "Neutral";
                    confidence = "60%";
                    tone = "Informative";
                }

                return { sentiment, confidence, tone };
            };

            const analyze = async () => {
                if (!text.trim()) return;
                setLoading(true);
                await new Promise(r => setTimeout(r, 800)); // Simulate processing
                setResult(analyzeSentimentLocal(text));
                setLoading(false);
            };

            return (
                <div className="flex flex-col lg:flex-row gap-6 p-6 h-full fade-in">
                    <div className="w-full lg:w-1/2 flex flex-col">
                        <textarea className="input-dark p-6 rounded-xl text-lg flex-1 resize-none mb-4" placeholder="Enter social media text to analyze..." value={text} onChange={e => setText(e.target.value)}></textarea>
                        <button onClick={analyze} className="bg-blue-600 hover:bg-blue-500 text-white py-4 rounded-xl font-bold text-lg transition shadow-lg shadow-blue-900/50 flex items-center justify-center gap-2">
                            {loading ? <LoadingDots /> : <><Icon name="zap" /> Run Analysis</>}
                        </button>
                    </div>
                    <div className="w-full lg:w-1/2">
                        <div className="glass-panel h-full rounded-xl p-8 flex flex-col justify-center items-center text-center relative overflow-hidden">
                            {!result ? (
                                <div className="text-gray-500">
                                    <Icon name="bar-chart" size={64} className="mx-auto mb-4 opacity-20" />
                                    <p>Results will appear here</p>
                                </div>
                            ) : (
                                <div className="space-y-6 w-full relative z-10">
                                    <div>
                                        <div className="text-sm text-gray-400 uppercase tracking-widest mb-2">Detected Sentiment</div>
                                        <div className={`text-5xl font-black ${result.sentiment === 'Positive' ? 'text-green-400' : result.sentiment === 'Negative' ? 'text-red-400' : 'text-gray-300'}`}>
                                            {result.sentiment}
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4 mt-8">
                                        <div className="bg-slate-800/50 p-4 rounded-lg">
                                            <div className="text-xs text-gray-500 uppercase">Tone</div>
                                            <div className="text-xl font-bold text-white">{result.tone}</div>
                                        </div>
                                        <div className="bg-slate-800/50 p-4 rounded-lg">
                                            <div className="text-xs text-gray-500 uppercase">Confidence</div>
                                            <div className="text-xl font-bold text-blue-400">{result.confidence}</div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 3. RECOMMENDATION ENGINE (With Pollinations AI Images)
        const FeatureRecommendation = () => {
            const [interests, setInterests] = useState(["Technology"]);
            const [articles, setArticles] = useState([]);
            const [loading, setLoading] = useState(false);
            const allInterests = [{ id: "Technology", i: "cpu" }, { id: "Sports", i: "trophy" }, { id: "Politics", i: "globe" }, { id: "Finance", i: "trending-up" }, { id: "Health", i: "activity" }, { id: "Gaming", i: "gamepad-2" }];

            const toggleInterest = (tag) => setInterests(prev => prev.includes(tag) ? prev.filter(t => t !== tag) : [...prev, tag]);
            const getRecs = async () => {
                setLoading(true);
                const data = await callGeminiAPI('/feature-2/recommend', { user_interests: interests, available_articles: [] }, {
                    recommended_articles: [{ id: 1, title: "Backend Offline", category: "System", source: "Local", time: "Now", snippet: "Start python backend.", image: "https://placehold.co/600x400/1e293b/FFF?text=Offline" }]
                });
                setArticles(data.recommended_articles || []);
                setLoading(false);
            };
            useEffect(() => { getRecs(); }, []);

            return (
                <div className="flex flex-col lg:flex-row gap-6 p-6 h-full fade-in overflow-hidden">
                    <div className="w-full lg:w-80 flex-shrink-0 space-y-4 overflow-y-auto">
                        <div className="glass-panel p-6 rounded-xl">
                            <h3 className="font-bold text-white mb-4">Feed Preferences</h3>
                            <div className="space-y-2">
                                {allInterests.map(item => (
                                    <button key={item.id} onClick={() => toggleInterest(item.id)} className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm transition ${interests.includes(item.id) ? 'bg-blue-600 text-white' : 'bg-slate-800/50 text-gray-400 hover:bg-slate-800'}`}>
                                        <Icon name={item.i} size={16} /> {item.id}
                                    </button>
                                ))}
                            </div>
                            <button onClick={getRecs} className="w-full mt-6 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white py-2 rounded-lg font-bold transition">Curate Feed</button>
                        </div>
                    </div>
                    <div className="flex-1 overflow-y-auto pr-2">
                        {loading ? <div className="text-center py-20"><LoadingDots /></div> : (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {articles.map((article, idx) => (
                                    <div key={idx} className="glass-panel rounded-xl overflow-hidden group cursor-pointer hover:border-blue-500/50 transition-all duration-300">
                                        <div className="h-48 overflow-hidden relative">
                                            <img src={article.image} className="w-full h-full object-cover transition duration-700 group-hover:scale-110" alt="news" />
                                            <span className="absolute top-4 left-4 bg-blue-600/90 backdrop-blur text-white text-[10px] font-bold px-2 py-1 rounded uppercase">{article.category}</span>
                                        </div>
                                        <div className="p-5">
                                            <div className="flex justify-between text-xs text-gray-500 mb-2"><span>{article.source}</span><span>{article.time}</span></div>
                                            <h3 className="text-lg font-bold text-white leading-tight mb-2 group-hover:text-blue-400 transition">{article.title}</h3>
                                            <p className="text-sm text-gray-400 line-clamp-2">{article.snippet}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // 4. TRANSLATION (Chat Style)
        const FeatureTranslate = () => {
            const [input, setInput] = useState("");
            const [output, setOutput] = useState("");
            const [loading, setLoading] = useState(false);
            const [lang, setLang] = useState("Bengali");

            const handleTranslate = async () => {
                if (!input) return;
                setLoading(true);
                const data = await callGeminiAPI('/feature-3/translate', { text: input, target_language: lang }, { translated_text: "Mock Translation Result" });
                setOutput(data.translated_text);
                setLoading(false);
            };

            return (
                <div className="max-w-3xl mx-auto p-6 h-full flex flex-col fade-in overflow-y-auto">
                    <div className="mb-8 text-center">
                        <h1 className="text-3xl font-black bg-gradient-to-r from-yellow-400 to-orange-400 bg-clip-text text-transparent mb-2">Live Translator</h1>
                        <p className="text-gray-400">Real-time multi-language translation powered by AI</p>
                    </div>

                    {/* Input Section */}
                    <div className="glass-panel rounded-2xl p-6 mb-6 border border-slate-700/50">
                        <div className="flex items-center justify-between mb-4">
                            <div className="text-xs text-gray-500 uppercase font-bold flex items-center gap-2"><Icon name="globe" size={14} /> English Input</div>
                            <span className="text-xs text-gray-600">{input.length} characters</span>
                        </div>
                        <textarea className="bg-slate-800/50 text-gray-200 p-4 rounded-xl resize-none outline-none border border-slate-700/50 focus:border-yellow-500/50 transition w-full placeholder-gray-600 focus:placeholder-gray-500" placeholder="Type or paste text to translate..." value={input} onChange={e => setInput(e.target.value)} rows="5"></textarea>
                    </div>

                    {/* Controls */}
                    <div className="glass-panel p-4 rounded-2xl flex items-center gap-3 mb-6 border border-slate-700/50">
                        <div className="flex-1">
                            <select className="bg-slate-800 text-white px-4 py-3 rounded-xl outline-none border border-slate-700/50 w-full font-semibold hover:border-yellow-500/50 focus:border-yellow-500/50 transition" value={lang} onChange={e => setLang(e.target.value)}>
                                <option value="Bengali">üáßüá© Bengali</option>
                                <option value="Spanish">üá™üá∏ Spanish</option>
                                <option value="French">üá´üá∑ French</option>
                                <option value="Hindi">üáÆüá≥ Hindi</option>
                                <option value="German">üá©üá™ German</option>
                                <option value="Japanese">üáØüáµ Japanese</option>
                                <option value="Arabic">üá∏üá¶ Arabic</option>
                            </select>
                        </div>
                        <button className="bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white py-3 px-8 rounded-xl font-bold transition flex items-center gap-2 shadow-lg shadow-yellow-900/50 whitespace-nowrap" onClick={handleTranslate} disabled={loading}>
                            {loading ? (
                                <><div className="w-4 h-4 border-2 border-yellow-300 border-t-white rounded-full animate-spin"></div> Translating</>
                            ) : (
                                <><Icon name="zap" size={18} /> Translate</>
                            )}
                        </button>
                    </div>

                    {/* Output Section */}
                    {output && (
                        <div className="glass-panel rounded-2xl p-6 border border-blue-500/30 mb-6 animate-fadeIn">
                            <div className="flex items-center justify-between mb-4">
                                <div className="text-xs text-gray-500 uppercase font-bold flex items-center gap-2"><Icon name="globe" size={14} /> {lang} Translation</div>
                                <span className="text-xs text-gray-600">{output.length} characters</span>
                            </div>
                            <div className="bg-gradient-to-br from-blue-600/10 to-purple-600/10 text-white p-4 rounded-xl border border-blue-500/20 min-h-32">
                                <p className="text-lg leading-relaxed">{output}</p>
                            </div>
                        </div>
                    )}

                    {loading && (
                        <div className="glass-panel rounded-2xl p-6 border border-yellow-500/30 mb-6 flex flex-col items-center justify-center min-h-32">
                            <div className="w-8 h-8 border-4 border-yellow-500/20 border-t-yellow-500 rounded-full animate-spin mb-3"></div>
                            <p className="text-sm text-gray-400">Translating your text...</p>
                        </div>
                    )}
                </div>
            );
        };

        // 5. SAFETY & FAKE NEWS (New Modern UI)
        const FeatureFakeNews = () => {
            const [text, setText] = useState("");
            const [result, setResult] = useState(null);
            const [loading, setLoading] = useState(false);

            const verify = async () => {
                if (!text) return;
                setLoading(true);
                // Simulated Mock
                const isFake = text.toLowerCase().includes("fake") || text.toLowerCase().includes("alien");
                const data = await callGeminiAPI('/feature-4/safety', { text }, {
                    status: isFake ? "Unsafe" : "Safe",
                    type: isFake ? "Potential Misinformation" : "Credible Content",
                    confidence: "94%",
                    sources: ["Reuters", "AP News"]
                });
                setResult(data);
                setLoading(false);
            };

            return (
                <div className="max-w-3xl mx-auto p-6 space-y-8 fade-in">
                    <div className="glass-panel p-8 rounded-2xl text-center">
                        <div className="w-16 h-16 bg-red-500/20 text-red-400 rounded-full flex items-center justify-center mx-auto mb-4">
                            <Icon name="shield-check" size={32} />
                        </div>
                        <h2 className="text-2xl font-bold text-white">Content Verification Shield</h2>
                        <p className="text-gray-400 mt-2">Detect Hate Speech, Cyberbullying & Fake News instantly.</p>
                    </div>

                    <div className="glass-panel p-1 rounded-2xl">
                        <textarea className="input-dark w-full p-6 rounded-xl text-lg resize-none h-40" placeholder="Paste headline or content to verify..." value={text} onChange={e => setText(e.target.value)}></textarea>
                        <button onClick={verify} className="w-full bg-red-600 hover:bg-red-500 text-white py-4 rounded-xl font-bold text-lg mt-2 transition flex items-center justify-center gap-2">
                            {loading ? <LoadingDots /> : "Verify Integrity"}
                        </button>
                    </div>

                    {result && (
                        <div className={`glass-panel p-6 rounded-2xl border-l-4 ${result.status === 'Safe' ? 'border-green-500' : 'border-red-500'} flex items-center justify-between fade-in`}>
                            <div>
                                <div className={`text-2xl font-bold ${result.status === 'Safe' ? 'text-green-400' : 'text-red-400'}`}>
                                    {result.status === 'Safe' ? '‚úÖ Credible Content' : '‚ö†Ô∏è Potential Threat Detected'}
                                </div>
                                <div className="text-gray-400 mt-1">{result.type} ‚Ä¢ {result.confidence} Confidence</div>
                            </div>
                            {result.sources && (
                                <div className="text-right">
                                    <div className="text-xs text-gray-500 uppercase font-bold mb-1">Cross-Referenced With</div>
                                    <div className="flex gap-2 justify-end">
                                        {result.sources.map((s, i) => <span key={i} className="bg-slate-800 text-xs px-2 py-1 rounded text-gray-300">{s}</span>)}
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        // 6. INSIGHTS & ANALYTICS (New Modern UI)
        const FeatureInsights = () => {
            const [topic, setTopic] = useState("AI Technology");
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(false);

            const getInsights = async () => {
                setLoading(true);
                const res = await callGeminiAPI('/feature-5/insights', { topic }, {
                    trend_prediction: "Rising",
                    volume: "1.2M",
                    sentiment_forecast: "Positive outlook due to new product launches.",
                    demographics: ["Gen Z", "Tech Professionals"],
                    chart_data: [30, 45, 40, 60, 55, 80, 95]
                });
                setData(res);
                setLoading(false);
            };

            useEffect(() => { getInsights(); }, []);

            return (
                <div className="p-6 h-full fade-in flex flex-col gap-6">
                    <div className="flex items-center gap-4">
                        <input className="input-dark px-4 py-3 rounded-xl w-80 font-bold" value={topic} onChange={e => setTopic(e.target.value)} />
                        <button onClick={getInsights} className="bg-pink-600 hover:bg-pink-500 text-white px-6 py-3 rounded-xl font-bold transition">Analyze Trend</button>
                    </div>

                    {loading ? <div className="flex-1 flex items-center justify-center"><LoadingDots /></div> : data && (
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 flex-1">
                            {/* Main Chart Simulation */}
                            <div className="lg:col-span-2 glass-panel p-8 rounded-2xl flex flex-col">
                                <h3 className="text-gray-400 uppercase font-bold text-sm mb-6">Engagement Velocity (7 Days)</h3>
                                <div className="flex-1 flex items-end justify-between gap-4 px-4 border-b border-l border-slate-700 pb-2 pl-2">
                                    {data.chart_data.map((h, i) => (
                                        <div key={i} className="w-full bg-pink-600/50 hover:bg-pink-500 transition-all rounded-t-sm relative group" style={{ height: `${h}%` }}>
                                            <div className="absolute -top-10 left-1/2 -translate-x-1/2 bg-white text-black px-2 py-1 rounded text-xs font-bold opacity-0 group-hover:opacity-100 transition">{h}k</div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* Stat Cards */}
                            <div className="space-y-6">
                                <div className="glass-panel p-6 rounded-2xl border-t-4 border-green-500">
                                    <div className="text-gray-400 text-xs font-bold uppercase">Trend Prediction</div>
                                    <div className="text-3xl font-bold text-white mt-2 flex items-center gap-2">{data.trend_prediction} <Icon name="trending-up" className="text-green-500" size={24} /></div>
                                </div>
                                <div className="glass-panel p-6 rounded-2xl">
                                    <div className="text-gray-400 text-xs font-bold uppercase">Volume</div>
                                    <div className="text-3xl font-bold text-white mt-2">{data.volume}</div>
                                </div>
                                <div className="glass-panel p-6 rounded-2xl">
                                    <div className="text-gray-400 text-xs font-bold uppercase">Key Demographics</div>
                                    <div className="flex gap-2 mt-3">
                                        {data.demographics.map(d => <span key={d} className="bg-slate-700 px-3 py-1 rounded-full text-sm">{d}</span>)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // 7. SUMMARIZER (New Modern UI)
        const FeatureSummary = () => {
            const [text, setText] = useState("");
            const [summary, setSummary] = useState("");
            const [loading, setLoading] = useState(false);

            const handleSummarize = async () => {
                if (!text) return;
                setLoading(true);
                const data = await callGeminiAPI('/feature-6/summary', { text }, { summary: "This is a mock summary. The AI generated a concise version of your text." });
                setSummary(data.summary);
                setLoading(false);
            };

            return (
                <div className="flex flex-col lg:flex-row gap-6 p-6 h-full fade-in">
                    <div className="w-full lg:w-1/2 flex flex-col">
                        <div className="text-gray-400 uppercase font-bold text-sm mb-2">Original Document</div>
                        <textarea className="input-dark p-6 rounded-xl flex-1 resize-none leading-relaxed font-mono text-sm" placeholder="Paste article or report content..." value={text} onChange={e => setText(e.target.value)}></textarea>
                    </div>
                    <div className="w-full lg:w-1/2 flex flex-col">
                        <div className="flex justify-between items-center mb-2">
                            <div className="text-green-400 uppercase font-bold text-sm">Executive Summary</div>
                            <button onClick={handleSummarize} className="bg-green-600 hover:bg-green-500 text-white px-4 py-1 rounded-lg text-sm font-bold transition">Summarize</button>
                        </div>
                        <div className="glass-panel flex-1 rounded-xl p-8 overflow-y-auto">
                            {loading ? <LoadingDots /> : (
                                summary ? <p className="text-lg leading-loose text-white">{summary}</p> : <div className="text-gray-500 italic">Summary will appear here...</div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // --- MAIN LAYOUT ---
        const App = () => {
            const [showProfile, setShowProfile] = useState(false);
            const profileRef = useRef(null);

            const profileData = {
                initials: "RR",
                name: "Rashed U.",
                email: "rashed@example.com",
                role: "Media Ops Lead",
                plan: "Enterprise",
                usagePercent: 82,
                lastActive: "Active 5m ago",
                locale: "Dhaka, BD",
                teams: ["News Curation", "Trust & Safety", "Insights"],
                seats: "12 / 15",
                creditsLeft: "18.4k credits left",
                apiStatus: "All endpoints stable",
            };

            // Close popover when clicking outside
            useEffect(() => {
                const handleClick = (e) => {
                    if (profileRef.current && !profileRef.current.contains(e.target)) {
                        setShowProfile(false);
                    }
                };
                document.addEventListener('mousedown', handleClick);
                return () => document.removeEventListener('mousedown', handleClick);
            }, []);

            return (
                <div className="flex h-screen bg-[#0B1121] overflow-hidden">
                    {/* Main Content Wrapper */}
                    <div className="flex-1 flex flex-col relative">

                        {/* Background Glows (Moved to back) */}
                        <div className="fixed inset-0 pointer-events-none z-0">
                            <div className="absolute top-[-10%] right-[-5%] w-[500px] h-[500px] bg-blue-600/10 rounded-full blur-[120px]"></div>
                            <div className="absolute bottom-[-10%] left-[-5%] w-[500px] h-[500px] bg-purple-600/10 rounded-full blur-[120px]"></div>
                        </div>

                        {/* Header - Forced to top of stacking context */}
                        <header className="h-20 border-b border-white/5 flex items-center justify-between px-8 z-40 bg-[#0f172a]/80 backdrop-blur-md">
                            <div className="flex items-center gap-4">
                                <span className="text-3xl font-black bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 bg-clip-text text-transparent tracking-tight">
                                    MediaMind
                                </span>
                            </div>

                            <div className="flex gap-4 items-center" ref={profileRef}>
                                <div className="hidden md:flex items-center gap-2 text-xs text-gray-400 mr-4">
                                    <span className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                    System: Optimal
                                </div>

                                <button className="relative w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-gray-400 hover:text-white transition">
                                    <Icon name="bell" size={18} />
                                    <span className="absolute w-2 h-2 bg-red-500 rounded-full top-2 right-2 border-2 border-[#0f172a]"></span>
                                </button>

                                <button className="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-gray-400 hover:text-white transition">
                                    <Icon name="settings" size={18} />
                                </button>

                                {/* Profile Trigger */}
                                <div className="relative ml-2">
                                    <button
                                        className="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm hover:scale-105 transition-transform shadow-lg shadow-blue-500/20"
                                        onClick={() => setShowProfile(!showProfile)}
                                    >
                                        {profileData.initials}
                                    </button>

                                    {/* Profile Popover - Fixed z-index and positioning */}
                                    {showProfile && (
                                        <div className="absolute right-0 top-14 w-80 bg-[#161f33] rounded-2xl border border-white/10 shadow-2xl p-5 z-50 animate-slide-up ring-1 ring-black/50">
                                            <div className="relative flex items-start gap-3 pb-4 border-b border-white/5">
                                                <div className="w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white font-bold text-lg">
                                                    {profileData.initials}
                                                </div>
                                                <div className="flex-1">
                                                    <div className="text-white font-semibold text-sm">{profileData.name}</div>
                                                    <div className="text-gray-400 text-xs">{profileData.email}</div>
                                                    <div className="text-emerald-400 text-[10px] font-bold mt-1 uppercase tracking-wider">{profileData.role}</div>
                                                </div>
                                            </div>

                                            <div className="mt-4 space-y-3">
                                                <div className="flex justify-between text-xs">
                                                    <span className="text-gray-400">Usage Status</span>
                                                    <span className="text-white font-medium">{profileData.usagePercent}%</span>
                                                </div>
                                                <div className="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden">
                                                    <div className="h-full bg-blue-500" style={{ width: `${profileData.usagePercent}%` }}></div>
                                                </div>

                                                <div className="grid grid-cols-1 gap-2 pt-2">
                                                    <div className="flex justify-between text-[11px]">
                                                        <span className="text-gray-500">Location</span>
                                                        <span className="text-gray-300">{profileData.locale}</span>
                                                    </div>
                                                    <div className="flex justify-between text-[11px]">
                                                        <span className="text-gray-500">Credits</span>
                                                        <span className="text-blue-400">{profileData.creditsLeft}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="mt-5 grid grid-cols-2 gap-2">
                                                <button className="py-2 bg-blue-600 hover:bg-blue-500 text-white text-xs font-bold rounded-lg transition">Settings</button>
                                                <button className="py-2 bg-slate-800 hover:bg-slate-700 text-gray-300 text-xs font-bold rounded-lg transition">Sign Out</button>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </header>

                        {/* Main View Area */}
                        <main className="flex-1 overflow-y-auto z-10 p-2">
                            <DashboardHome />
                        </main>
                    </div>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>